$(document).ready(function(){function e(t){for(var e,a,i=t.length;i;e=parseInt(Math.random()*i),a=t[--i],t[i]=t[e],t[e]=a);return t}var a=1;let i="https://api.mercadolibre.com/sites/MLA/categories";$.getJSON(i,function(e){var a=[];for($.each(e,function(t,e){"MLA1071"==e.id||"MLA1540"==e.id||"MLA1512"==e.id||a.push({label:e.name,value:e.id})}),t=0;t<a.length;t++)$("#hidden_categories").append(new Option(a[t].label,a[t].value))}),$("#main-btn").click(function(){$(".product-img").fadeOut();let t=$("#tope").val(),i="MLA",r=$("#hidden_categories").val();if(""==t||""==r)return $("#result").html("<p>ElegÃ­ una categorÃ­a y completa cuanto queres gastar ðŸ¤”</p>"),$("#result").show(),$("#share").html(""),$("#share").hide(),!1;$(".form-signin").effect("shake");var s="https://api.mercadolibre.com/sites/"+i+"/search?status=active&category="+r;$.getJSON(s,function(i){if(void 0===i.results)$("#result").html("<p> No encontre nada por ese precio ðŸ˜¢</p>"),$("#share").html(""),$("#share").hide(),$("#result").show();else{var r=[];if($.each(i.results,function(e,a){a.price<=t&&r.push({id:a.id,price:a.price,thumbnail:a.thumbnail,title:a.title,permalink:a.permalink,free_shipping:a.shipping.free_shipping,listing_type:a.listing_type_id})}),r.length<1)return $("#result").html("<p> No encontre nada por ese precio ðŸ˜¢</p>"),$("#share").html(""),$("#share").hide(),$("#result").show(),!1;e(r),e(r),r[0].thumbnail=r[0].thumbnail.replace("http://","https://");let s='<p><img src="'+r[0].thumbnail+'" class="product-img"></p>';s+='<p class="title">'+r[0].title+"</p>",s+='<p class="price">$ '+r[0].price+"</p>",r[0].free_shipping&&(s+='<p class="shipping">EnvÃ­o gratis</p>'),"gold_pro"==r[0].listing_type&&(s+='<p class="listing_type">Cuotas sin interes</p>'),s+='<a target="_blank" href="'+r[0].permalink+'" class="w-100 btn btn-lg btn-primary mb-3">Comprar ahora</a>',s+='<p class="divider"></p>';let n="Â¿No sabes quÃ© comprar o regalar?";n+=" ðŸ“¦ ðŸ“¦ Busca tu prÃ³xima compra random de Mercado Libre en ðŸ‘‡ ",$("#share").html('<a class="twitter-share-button" href="https://twitter.com/intent/tweet" data-size="large"  data-url="https://chcibelli.github.io/shake-n-buy/" data-text="'+n+'">Tweet</a>'),twttr.widgets.load(),1==a?($("#main-btn").html("No me gusto, dame otra cosa!"),a=2):($("#main-btn").html("Sigue sin gustarme! Otra!"),a=1),$("#result").html(s),$("#result, #share").show()}})}),$("#tope").on("keypress",function(t){return 13==t.which?($("#main-btn").click(),!1):!(t.which>31&&(t.which<48||t.which>57))})});